<?php
// Memuat autoloader dari PHPExcel
require 'vendor/autoload.php';

// Membuat objek Spreadsheet baru
$spreadsheet = new PhpOffice\PhpSpreadsheet\Spreadsheet();
$sheet = $spreadsheet->getActiveSheet();

// Mengatur header kolom
$sheet->setCellValue('A1', 'Date');
$sheet->setCellValue('B1', 'Daily Min LOS');
$sheet->setCellValue('C1', 'Daily Availability');

// Inisialisasi tanggal
$date = new DateTime('2024-03-26');

// Data $DailyMinLOS dan $DailyAvailability
$DailyMinLOS = '9902020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202030303030302020202020202020202020202020202020202020202020203030303030202020202020202020202020202020202020202020202020303030302020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999';
$DailyAvailability = 'OUUIAOUUUUUIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOUIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA';

// Array asosiatif untuk memberikan keterangan pada nilai-nilai dalam $DailyAvailability
$cico_info = array(
    'O' => 'Check Out Only',
    'U' => 'Unavailable',
    'I' => 'Check In Only',
    'A' => 'Available (Check In/Check Out)'
);

// Iterasi dan menulis data ke baris spreadsheet
$array = str_split($DailyMinLOS, 2);
$row = 2; // Mulai dari baris kedua
foreach ($array as $key => $value) {
    // Menampilkan tanggal, nilai dari $DailyMinLOS, dan keterangan dari $DailyAvailability
    $sheet->setCellValue('A' . $row, $date->format('Y-m-d'));
    $sheet->setCellValue('B' . $row, $value);
    $sheet->setCellValue('C' . $row, $cico_info[$DailyAvailability[$key]]);

    $date->modify('+1 day');
    $row++;
}

// Menyimpan spreadsheet ke file Excel
$writer = new PhpOffice\PhpSpreadsheet\Writer\Xlsx($spreadsheet);
$writer->save('output.xlsx');
